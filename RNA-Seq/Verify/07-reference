#!/bin/sh -e

printf "All the numbers below should be the same.\n\n"

ref_dir=Results/07-reference
gtf=$(Reference/gtf-filename.sh)
gff=$(Reference/gff-filename.sh)
transcriptome=$(Reference/transcriptome-filename.sh)
transcriptome_gff=transcriptome-gff.fa
genome=$(Reference/genome-filename.sh)

printf "$gtf (awk '$3 ~ \"transcript\"'):\n"
awk '$3 ~ "transcript"' $ref_dir/$gtf | wc -l

# "transccript" in the GTF translates to various feature names in
# the GFF.  Transcripts can be identitied by the ID in col 9.
printf "$gff (awk '$9 ~ \"ID=transcript:ENSMUST\"'):\n"
awk '$9 ~ "ID=transcript:ENSMUST"' $ref_dir/$gff | wc -l

printf "$transcriptome generated by gffread if using gtf2fasta:\n"
grep '^>' $ref_dir/$transcriptome | awk '{ print $1 }' | sort | uniq | wc -l

printf "Transcriptome generated by gffread using GFF instead of GTF:\n"
gffread -w $ref_dir/$transcriptome_gff -g $ref_dir/$genome $ref_dir/$gff
grep '^>' $ref_dir/$transcriptome_gff | wc -l
